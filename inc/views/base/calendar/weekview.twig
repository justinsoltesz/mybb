{% extends 'layouts/master.twig' %}

{% block head %}
    <title>{{ mybb.settings.bbname }} - {{ lang.calendar }}</title>
{% endblock head %}

{% block body %}
    <header class="page-header">
        <h1 class="title title--page">{{ lang.weekly_overview }}</h1>
        <p class="page-description">{{ calendar.friendly_week_from }} {{ lang.through }} {{ calendar.friendly_week_to }}</p>
    </header>
    <div class="page-controls page-controls--top">
        <div class="calendar-nav">
            {% if calendar.prev_week_link %}
                <a href="{{ calendar.prev_week_link|raw }}" class="button button--basic">
                    <i class="button__icon fas fa-angle-left"></i>
                    <span class="button__text">{{ lang.previous_week }}</span>
                </a>
            {% endif %}
            {% if calendar.next_week_link %}
                <a href="{{ calendar.next_week_link|raw }}" class="button button--basic">
                    <span class="button__text">{{ lang.next_week }}</span>
                    <i class="button__icon button__icon--after fas fa-angle-right"></i>
                </a>
            {% endif %}
        </div>
        <div class="page-buttons">
            {% if calendar_permissions.canaddevents %}
                <a href="calendar.php?action=addevent&amp;calendar={{ calendar.cid }}" class="button button--half-width">
                    <i class="button__icon fas fa-calendar-plus"></i>
                    <span class="button__text">{{ lang.add_public_event }}</span>
                </a>
                <a href="calendar.php?action=addevent&amp;calendar={{ calendar.cid }}&amp;private=1" class="button button--half-width">
                    <i class="button__icon fas fa-calendar-plus"></i>
                    <span class="button__text">{{ lang.add_private_event }}</span>
                </a>
            {% endif %}
        </div>
    </div>
    <div class="page-content page-content--sidebar">
        <div class="calendar calendar--week">
            {% for weekday in weekdays %}
                <div class="calendar__week">
                    <h2 class="title title--major">{{ weekday.month }} {{ weekday.year }}</h2>
                    {% for day in weekday.days %}
                        {% if day.weekday_month == weekday.monthnum %}
                            <div class="calendar__day {{ day.day_shaded }}">
                                <span class="calendar__day-of-week">{{ day.weekday_name }}</span>
                                <h2 class="calendar__day-heading">{{ day.weekday_day }}</h2>
                                {% if day.bday_count > 0 %}
                                    <p class="calendar__event"><a href="{{ day.calendar_link|raw }}" class="calendar__event-link calendar__event-link--birthdays">{{ day.bday_count }} {{ day.birthday_lang }} <i class="calendar__event-icon fas fa-birthday-cake"></i></a></p>
                                {% endif %}
                                {% for event in day.events %}
                                    <p class="calendar__event">
                                        <a href="{{ event.eventlink|raw }}" class="calendar__event-link {{ event.event_class }}" title="{{ event.fullname }}">{{ event.fullname }} {% if event.time_period %}<span class="calendar__event-time-period">({{ event.time_period }})</span>{% endif %}</a>
                                    </p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            {% endfor %}
        </div>
    </div>
    <div class="page-sidebar">
        {% for mini_calendar in mini_calendars %}
            <table border="0" cellspacing="{{ theme.borderwidth }}" cellpadding="{{ theme.tablespace }}" class="tborder" style="width: 180px;">
                <thead>
                    <tr>
                        <td class="thead" colspan="8">
                            <strong><a href="{{ mini_calendar.month_link|raw }}">{{ mini_calendar.month }} {{ mini_calendar.year }}</a></strong>
                        </td>
                    </tr>
                    <tr>
                        <td class="tcat">&nbsp;</td>
                        {% for weekday_header in mini_calendar.weekday_headers %}
                            <td class="tcat" align="center" width="14%"><strong>{{ weekday_header }}</strong></td>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for week in mini_calendar.week %}
                        <tr>
                            <td class="tcat" align="center" width="1"><a href="{{ week.week_link|raw }}">&raquo;</a></td>
                            {% for day in week.days %}
                                <td class="{{ day.day_class }}" valign="middle" align="center">
                                    {% if day.link %}
                                        <a href="{{ day.link|raw }}">{{ day.day }}</a>
                                    {% else %}
                                        {{ day.day }}
                                    {% endif %}
                                </td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endfor %}
    </div>
    <footer class="page-footer">
        {% include 'calendar/calendar_select.twig' %}
    </footer>
{% endblock body %}
